// prisma/schema.prisma
datasource db {
  provider  = "postgresql"
  url  	    = env("DATABASE_URL")
  // uncomment next line if you use Prisma <5.10
  // directUrl = env("DATABASE_URL_UNPOOLED")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id              String         @id @default(uuid())
  username        String         @unique @map("user_name")
  email           String         @unique @map("user_email")
  firstName       String         @map("user_first_name")
  lastName        String         @map("user_last_name")
  dateOfBirth     DateTime       @map("user_dob")
  dateCreated     DateTime       @default(now()) @map("user_date_created")
  lastLogin       DateTime?      @map("user_last_login")
  isActive        Boolean        @default(true) @map("user_is_active")
  
  // Relations
  role            Role           @relation(fields: [roleId], references: [id])
  roleId          String         @map("role_id")
  authentication  Authentication?

  @@map("users")
}

model Role {
  id          String   @id @default(uuid())
  name        String   @unique @map("role_name")
  description String?  @map("role_desc")
  users       User[]

  @@map("roles")
}

model Authentication {
  id              String    @id @default(uuid())
  passwordHash    String    @map("auth_password_hash")
  passwordReset   String?   @map("auth_password_reset")
  loginAttempts   Int       @default(0) @map("auth_login_attempts")
  lockoutEndTime  DateTime? @map("auth_lockout_end_time")
  
  // Relations
  user            User      @relation(fields: [userId], references: [id])
  userId          String    @unique @map("user_id")

  @@map("authentications")
}